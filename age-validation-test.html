<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Age Validation Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 p-8">
    <div class="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow-lg">
        <h1 class="text-2xl font-bold mb-6">Age Validation Test</h1>
        
        <div class="space-y-4">
            <div>
                <h3 class="text-lg font-semibold mb-2">Current Date:</h3>
                <p id="currentDate" class="text-gray-600"></p>
            </div>
            
            <div>
                <h3 class="text-lg font-semibold mb-2">Test Cases:</h3>
                <button onclick="runAllTests()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                    Run All Age Tests
                </button>
            </div>
            
            <div id="results" class="mt-6 space-y-2"></div>
        </div>
    </div>

    <script>
        // Copy the exact calculateAge function from registerPage-functions.js
        function calculateAge(birthMonth, birthDay, birthYear) {
            const today = new Date();
            const birthDate = new Date(birthYear, birthMonth - 1, birthDay); // month is 0-indexed
            
            let age = today.getFullYear() - birthDate.getFullYear();
            const monthDiff = today.getMonth() - birthDate.getMonth();
            
            // If birthday hasn't occurred this year, subtract a year
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                age--;
            }
            
            return age;
        }

        function displayCurrentDate() {
            const now = new Date();
            document.getElementById('currentDate').textContent = now.toLocaleDateString() + ' (' + now.toDateString() + ')';
        }

        function testAge(birthMonth, birthDay, birthYear, description) {
            const age = calculateAge(birthMonth, birthDay, birthYear);
            const today = new Date();
            const birthDate = new Date(birthYear, birthMonth - 1, birthDay);
            const isValid = age >= 18;
            
            const resultDiv = document.createElement('div');
            resultDiv.className = `p-3 rounded ${isValid ? 'bg-green-100 border border-green-300' : 'bg-red-100 border border-red-300'}`;
            
            resultDiv.innerHTML = `
                <p class="font-semibold">${description}</p>
                <p><strong>Birth Date:</strong> ${birthDate.toDateString()}</p>
                <p><strong>Calculated Age:</strong> ${age} years old</p>
                <p class="${isValid ? 'text-green-700' : 'text-red-700'}">
                    <strong>Result:</strong> ${isValid ? '✅ Valid (18+)' : '❌ Invalid (Under 18)'}
                </p>
            `;
            
            return resultDiv;
        }

        function runAllTests() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '';
            
            const today = new Date();
            const currentYear = today.getFullYear();
            const currentMonth = today.getMonth() + 1; // Convert from 0-indexed
            const currentDay = today.getDate();
            
            const tests = [
                // Test case 1: Exactly 18 years old today
                [currentMonth, currentDay, currentYear - 18, "Exactly 18 years old today"],
                
                // Test case 2: Turns 18 tomorrow (should be INVALID)
                [currentMonth, currentDay + 1, currentYear - 18, "Turns 18 tomorrow (should be INVALID)"],
                
                // Test case 3: Turned 18 yesterday
                [currentMonth, currentDay - 1, currentYear - 18, "Turned 18 yesterday"],
                
                // Test case 4: 17 years old, birthday next month
                [currentMonth + 1, currentDay, currentYear - 18, "17 years old, birthday next month (should be INVALID)"],
                
                // Test case 5: 19 years old
                [currentMonth, currentDay, currentYear - 19, "19 years old"],
                
                // Test case 6: 17 years and 11 months old
                [currentMonth - 1, currentDay, currentYear - 17, "17 years and 11 months old (should be INVALID)"],
                
                // Test case 7: Edge case - February 29th handling
                [2, 29, currentYear - 18, "Born on Feb 29th, 18 years ago (leap year test)"]
            ];
            
            tests.forEach(([month, day, year, description]) => {
                try {
                    // Handle date edge cases (like day 32, month 13, etc.)
                    if (month > 12) month = 12;
                    if (month < 1) month = 1;
                    if (day > 31) day = 31;
                    if (day < 1) day = 1;
                    
                    const resultDiv = testAge(month, day, year, description);
                    resultsDiv.appendChild(resultDiv);
                } catch (error) {
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'p-3 rounded bg-yellow-100 border border-yellow-300';
                    errorDiv.innerHTML = `
                        <p class="font-semibold">${description}</p>
                        <p class="text-yellow-700"><strong>Error:</strong> ${error.message}</p>
                    `;
                    resultsDiv.appendChild(errorDiv);
                }
            });
        }

        // Initialize
        displayCurrentDate();
        runAllTests();
    </script>
</body>
</html>
