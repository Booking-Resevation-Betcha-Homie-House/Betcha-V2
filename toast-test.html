<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toast Notification Test</title>
    <link rel="stylesheet" href="/src/index.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }
        button {
            margin: 10px 5px;
            padding: 8px 15px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #0056b3;
        }
        .info {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #007bff;
            margin: 10px 0;
        }
        .form-group {
            margin: 15px 0;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, textarea, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Toast Notification Test for Ticket Creation</h1>
        <p>This page tests the toast notification system integrated with the ticket creation form.</p>

        <div class="info">
            <h4>ðŸŽ¯ What's being tested:</h4>
            <ul>
                <li><strong>Success toasts</strong> - Green with checkmark icon</li>
                <li><strong>Error toasts</strong> - Red with warning icon</li>
                <li><strong>Warning toasts</strong> - Yellow with warning icon</li>
                <li><strong>Auth toasts</strong> - Purple with lock icon</li>
            </ul>
        </div>

        <div class="test-section">
            <h3>Toast Type Tests</h3>
            <button onclick="testSuccessToast()">Test Success Toast</button>
            <button onclick="testErrorToast()">Test Error Toast</button>
            <button onclick="testWarningToast()">Test Warning Toast</button>
            <button onclick="testAuthToast()">Test Auth Toast</button>
        </div>

        <div class="test-section">
            <h3>Validation Toast Tests</h3>
            <button onclick="testAgentRequired()">Test "Agent Required"</button>
            <button onclick="testCategoryRequired()">Test "Category Required"</button>
            <button onclick="testDescriptionRequired()">Test "Description Required"</button>
            <button onclick="testLoginRequired()">Test "Login Required"</button>
        </div>

        <div class="test-section">
            <h3>Quick Form Test</h3>
            <div class="form-group">
                <label>Set User ID (for testing):</label>
                <button onclick="setTestUser()">Set Test User</button>
                <button onclick="clearUser()">Clear User</button>
            </div>

            <!-- Simplified form for testing -->
            <form id="testForm" onsubmit="return false;">
                <div class="form-group">
                    <label>Agent (Dropdown simulation):</label>
                    <select id="agentSelect" onchange="selectAgent()">
                        <option value="">Select Agent</option>
                        <option value="test-agent-1">CS - Test Agent 1</option>
                        <option value="test-agent-2">CS - Test Agent 2</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Category (Dropdown simulation):</label>
                    <select id="categorySelect" onchange="selectCategory()">
                        <option value="">Select Category</option>
                        <option value="Location">Location</option>
                        <option value="Appliances">Appliances</option>
                        <option value="Payment">Payment</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Description:</label>
                    <textarea id="description" rows="4" placeholder="Enter your issue description..."></textarea>
                </div>

                <button type="button" onclick="testFormValidation()">Test Form Validation</button>
            </form>
        </div>
    </div>

    <script type="module">
        // Import toast notification
        import { showToastError } from '/src/toastNotification.js';
        window.showToastError = showToastError;

        // Global variables for testing
        window.selectedAgent = null;
        window.selectedCategory = null;

        // Test functions
        window.testSuccessToast = function() {
            showToastError('success', 'Ticket Created!', 'Your support ticket has been created successfully. You will be redirected shortly.');
        };

        window.testErrorToast = function() {
            showToastError('error', 'Creation Failed', 'Failed to create ticket. Please try again.');
        };

        window.testWarningToast = function() {
            showToastError('warning', 'Missing Information', 'Please fill in all required fields.');
        };

        window.testAuthToast = function() {
            showToastError('auth', 'Login Required', 'User not logged in. Please log in to create a ticket.');
        };

        // Validation test functions
        window.testAgentRequired = function() {
            showToastError('warning', 'Agent Required', 'Please select a Customer Service Agent before creating a ticket.');
        };

        window.testCategoryRequired = function() {
            showToastError('warning', 'Category Required', 'Please select a concern category before creating a ticket.');
        };

        window.testDescriptionRequired = function() {
            showToastError('warning', 'Description Required', 'Please provide a description with at least 10 characters.');
        };

        window.testLoginRequired = function() {
            showToastError('auth', 'Login Required', 'User not logged in. Please log in to create a ticket.');
        };

        // User management for testing
        window.setTestUser = function() {
            localStorage.setItem('userId', '685009ff53a090e126b9e2b4');
            showToastError('success', 'User Set', 'Test user ID has been set in localStorage.');
        };

        window.clearUser = function() {
            localStorage.removeItem('userId');
            localStorage.removeItem('userID');
            localStorage.removeItem('currentUser');
            showToastError('warning', 'User Cleared', 'User ID has been cleared from localStorage.');
        };

        // Form simulation functions
        window.selectAgent = function() {
            const select = document.getElementById('agentSelect');
            window.selectedAgent = select.value;
            if (select.value) {
                showToastError('info', 'Agent Selected', `Selected: ${select.options[select.selectedIndex].text}`);
            }
        };

        window.selectCategory = function() {
            const select = document.getElementById('categorySelect');
            window.selectedCategory = select.value;
            if (select.value) {
                showToastError('info', 'Category Selected', `Selected: ${select.value}`);
            }
        };

        // Form validation test
        window.testFormValidation = function() {
            const description = document.getElementById('description').value.trim();
            const userId = localStorage.getItem('userId') || localStorage.getItem('userID') || localStorage.getItem('currentUser');

            // Test all validation conditions
            if (!window.selectedAgent) {
                showToastError('warning', 'Agent Required', 'Please select a Customer Service Agent before creating a ticket.');
                return;
            }

            if (!window.selectedCategory) {
                showToastError('warning', 'Category Required', 'Please select a concern category before creating a ticket.');
                return;
            }

            if (!description || description.length < 10) {
                showToastError('warning', 'Description Required', 'Please provide a description with at least 10 characters.');
                return;
            }

            if (!userId) {
                showToastError('auth', 'Login Required', 'User not logged in. Please log in to create a ticket.');
                return;
            }

            // All validation passed
            showToastError('success', 'Validation Passed!', 'All fields are valid. Ready to create ticket!');
        };
    </script>
</body>
</html>
